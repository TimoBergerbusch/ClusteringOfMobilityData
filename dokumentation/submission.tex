% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
%
\usepackage{graphicx}
%\usepackage{ngerman}
\usepackage[utf8x]{inputenc}
\usepackage{fancyvrb}
\usepackage{courier}
\usepackage{helvet}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{pdfpages}
\usetikzlibrary{calc}
\usepackage[strict]{changepage}
\usepackage{xspace}
\usepackage{hyperref}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta, automata, shapes, matrix,positioning}
\usepackage{amssymb}
\usepackage{pifont}% http://ctan.org/pkg/pifont
\usepackage{subcaption} 
\usepackage{float}
\usepackage{fixfoot}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{multicol}
\usepackage{amsmath}
\usepackage{cleveref}
\usepackage{listings}

\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following line
% to display URLs in blue roman font according to Springer's eBook style:
% \renewcommand\UrlFont{\color{blue}\rmfamily}

\begin{document}
	
	
	%
	%	\title{Clustering Analysis of Mobility Data}
	\title{Are you moving predictably?}
	%
	%\titlerunning{Abbreviated paper title}
	% If the paper title is too long for the running head, you can set
	% an abbreviated paper title here
	%
	%TODO: Order by Lastname?
	\author{Miriam Wagner\and
		Martin Breuer\and
		Moritz Werthebach\and
		Timo Bergerbusch\and
		Walter Schikowski}
	%
	\authorrunning{T. Bergerbusch et al.} %TODO
	% First names are abbreviated in the running head.
	% If there are more than two authors, 'et al.' is used.
	%
	\institute{RWTH Aachen, Templergraben 55, 52062 Aachen, Germany}
	%
	\maketitle              % typeset the header of the contribution
	%
	\begin{abstract} %TODO
		We analyze movements in the urban environment of the columbian city Medellín. Each movement is given as spatiotemporal pattern of with additional information about the reason, means of transportation and the corresponding person like the socio-economic status (strata), the age and gender. Since in most cases we do not have information about the actual socio-economic status of persons we firstly try different unsupervised approaches to find natural clusters. Due to bad results we introduce our preprocessing steps and switch to supervised learning. Decision trees and neural networks did neither match our performance expectations which leads to our conclusion that we need more data and information about the data in order to find a proper social stratification and to predict the given socio-economic status accurately.
		
		\keywords{Data Mining \and Clustering \and Rapidminer \and Cluster \and Neural Nets} %TODO: maybe more
	\end{abstract}
	%
	%
	%
	\section{Introduction} \label{sec: introduction}
	%	TODO (1 page)
	% could at more in depth 
	Within the time of Industry 4.0 and various data sources the question arises, if one can define who we are by the data collected? In particular is it possible to determine the wealth of a person, only given movements of a single day?
	For this we considered the dataset stated in \cite{rich_do_not_rise_early}. There we have a set of 124979 rows of movement data from various persons from a Columbian town, called Medellín. All the data was collected at a single day, with possibly multiple entries referring to the same person.\\
	The data entries consist of data about the movement, like endpoints or length, and also some meta parameters like gender, age or the so-called strata of the person. The strata defines the socio-economic group, reflecting the affluence and therefore impose the ancillary costs.\\
	Our goal is to ascertain if there is a correlation between the movements and the strata. 
	
	\section{Preprocessing}\label{sec: proprocessing}
	In order to classify the given data into smaller test sets or mask different aspects, we have to perform some analysis.\\
	We observe that even though we have 124979 individual lines defining a movement, there is one line defining a \texttt{NotANumber}-exception and therefore gets neglected for further usage.	\\
	We provide the \texttt{testDataGenerator} python script. Through flags and input arguments, the script is able to create all test sets considered by our clustering and neural net approaches.\\
	We observe the following distribution over the whole dataset:\\
	\begin{figure}[H]
		\centering
		\setlength\tabcolsep{.2cm}
		\begin{tabular}{c|ccccccc}
			strata &  1   &   2   &   3   &  4   &  5   &  6   & $\Sigma$ \\ \hline
			abs   & 6963 & 52265 & 49404 & 8772 & 5536 & 2038 &  124978  \\
			\%   & 5.57 & 41.82 & 39.53 & 7.02 & 4.43 & 1.63 &   100
		\end{tabular}
		\label{table: distribution normal}
	\end{figure}
	We observe that there is an upper bound on equal distribution through strata 6. It has at most 2038 individual elements.
	Furthermore we have to make sure that  two different data points, which belong to the very same person, are assigned to the same cluster. To do so we compute the value \texttt{ID} which identifies each person and can be used to combine movements that are considered to be from the same person, i. e. two movements correspond with the very same person, if and only if they are consecutive in the original dataset and have the same strata, age and gender. This approach is taken since the surveys are concatenated sequentially and it is unlikely, that multiple consecutive movements with same strata, age, gender belong to two different persons.
	\begin{figure}[H]
		\centering
		\setlength\tabcolsep{.2cm}
		\begin{tabular}{c|ccccccc}
			strata &  1   &   2   &   3   &  4   &  5   &  6  & $\Sigma$ \\ \hline
			abs   & 3153 & 23367 & 21418 & 3497 & 2083 & 595 &  54113   \\
			\%   & 5.83 & 43.18 & 39.58 & 6.46 & 3.85 & 1.1 &   100
		\end{tabular}
	\end{figure}
	In Section \Cref{subsec: person vector data} we introduce vectors representing single persons. Since strata 6 is the smallest strata with 595 persons, it limits the size of an equally distributed dataset where each data point coincides with one person.
	
	\subsection{Stratified Person Data}\label{subsec: person vector data}
	As stated before, instead of simple IDs for every person we expand the parsing by using a data encapsulating in a class called \texttt{Person}. This class stores the ID, the parameters defining a person %TODO: ref zu code basics
	, and all movements from that person.\\
	Then we are able to compute the following vector, with 850 entries, for further usage, that combines all movements of the person:
	\begin{align*}
	\underbrace{\#o_1, \dots, \#o_{413}, \#d_1, \dots, \#d_{413}}_{2\cdot 413} ,
	\underbrace{\mathit{AM}, \mathit{MD}, \mathit{PM}, \mathit{MN}}_{4}, 
	\underbrace{\#r_1, \dots, \#r_7}_{7}, \\
	\underbrace{\#\mathit{MoT}_1, \dots, \#\mathit{MoT}_7}_{7}, \underbrace{\mathit{S_{Dest}}, \mathit{S_{Dist}}, \mathit{G}, \mathit{A} ,\mathit{strata}, \mathit{strataGrouped}}_{6}
	\end{align*}
	with the following abbreviations ($1 \le i \le 413$, $1 \le j \le 7$):
	\begin{multicols}{2}
		\begin{itemize}
			\setlength{\itemindent}{.4cm}
			\item[$o_i$:]  the $i$-th origin data point
			\item[$d_i$:]  the $i$-th destination data point
			\item[$\mathit{AM}$:] movements at time stamp AM
			\item[$\mathit{MD}$:] movements at time stamp MD
			\item[$\mathit{PM}$:] movements at time stamp PM
			\item[$\mathit{MN}$:] movements at time stamp MN
			\item[$r_j$:] the $j$-th reason
			\item[$\mathit{MoT}_j$:] the $j$-th mean of transportation
			\item[$\mathit{S_{Dest}}$:] sum of all durations
			\item[$\mathit{S_{Dist}}$:] sum of all distances
			\item[$\mathit{G}$:] the gender
			\item[$\mathit{A}$:] the age
			\item[$strata$:] the strata (used for comparison)
			\item[$strataGrouped$:] the aggregated stratas
		\end{itemize}
	\end{multicols}
	\section{Predicting}
	
	\subsection{Distance Measures} \label{subsec: distance measures}
	%TODO: distance measures
	%TODO (1 page)
	
	\subsection{Classification} \label{subsec: classification}
	%TODO: clustering
	%TODO (5 pages)	
	{}\input{MiriamClustering}

	\input{DecisionTree}
	%\subsection{Neural Net}
	%TODO (5 pages)	
	\subsection{Neural Net} \label{subsec: neural net}
	For all the neural net computations we considered person vector data sets of different sizes (c.f. \Cref{subsec: person vector data}).\\
	
	We do this, because results on the normal datasets had an unacceptable performance, since only single movements and not complete paths of individuals are considered. An example training and performance measure is given in \Cref{fig: NN without vector} where unprocessed data is used. The performance is measured using 10-fold cross validation, i. e. the data is split into 10 subsets where in each iteration exactly one data set is used as test set and the other 9 as training set. The average value of the accuracy values lead
	to the total accuracy value of the neural net.
	\begin{figure}[H]
		\centering
		\includegraphics[scale = 0.4]{src/pic/NN_without_vector.png}
		\caption{An example of a neural net trained without person vector data.}
		\label{fig: NN without vector}
	\end{figure}
	
	In the following we consider 3 neural nets $\mathcal{N}_1,\mathcal{N}_2$ and $\mathcal{N}_3$, all having 4 hidden layers, 50 epochs and 10 iterations.	
	As an example of other strata aggregation we combine the stratas 1--2, 3--4 and 5--6 together and call them $\mathcal{N}_i^\star$, for $i \in \{5,10,20\}$. This builds a superset of the original stratas and since the stratas themselves are logically connected this task should be easier to fulfill.\\
	
	For each neural net we are using equally distributed data sets with 100, 200 and the maximal amount of 595 individuals per strata which are provided by the \texttt{testDataGenerator} from \Cref{sec: proprocessing}. For every neural net and every set size we performed 5 independent runs and calculated the average over those accuracy values in order to have a sophisticated, comparable statements. 
	\setlength\tabcolsep{.2cm}
	\begin{figure}[H]
		\centering
		\begin{tabular}{|c|c|c|c|c|c|}
			\hline
			&   \#    &        & \multicolumn{3}{c|}{Set size} \\
			Name           & Neurons &   AG   &  100  &  200  &      595      \\ \hline
			$\mathcal{N}_5$      &    5    & \xmark & 60.03 & 59.92 &     60.18     \\
			$\mathcal{N}_5^\star$   &    5    & \cmark & 87.6  & 89.7  &     71.05     \\
			$\mathcal{N}_{10}$    &   10    & \xmark & 75.83 & 73.54 &     69.56     \\
			$\mathcal{N}_{10}^\star$ &   10    & \cmark & 92.93 & 93.48 &     74.58     \\		
			%		$\mathcal{N}_{10}^\star$ &   10    & \cmark & 88.33 {\small $\pm$7.49} & 90.67{\small $\pm$2.81} & 92.14 {\small $\pm$ 2.59} \\
			$\mathcal{N}_{20}$    &   20    & \xmark & 75.45 & 71.14 &     61.87     \\
			$\mathcal{N}_{20}^\star$ &   20    & \cmark & 92.87 & 94.4  &     78.32     \\ \hline
		\end{tabular}
		\caption{The accuracy values of the neural nets. (See excel-spreadsheet)}
		\label{tab: nn-accuracy}
		% mittels deep-learning-vector-average
	\end{figure}
	
	%TODO: recompute
	The size of larger nets in terms of neurons is counter-productive, since if we take 50 neurons per layer we have $14 \cdot 50^4 \cdot 6 \approxeq 525.000.000$ synapses for which the input data set would be too small to have sufficient training.\\
	
	\section{Observations} \label{sec: observation}
	%	TODO (1 page)
	%	TODO: restructure. Have like 3 parts
	%	The greater the population, the more the borders between the stratas blur. 
	As an overall result we get, that we can not determine the strata based on the information we have.
	Using various datasets (c.f. \Cref{sec: proprocessing}), we witnessed that having equally distributed datasets lead to an overall higher accuracy. This rules out the bias observed in the original data, where strata 2 and 3 are very dominant (c.f. \Cref{table: distribution normal}), but also reduces the set size from originally 124978 to $6*2038=12228$ entries equally distributed over all stratas.\\
	During clustering we observed, that using a different distance measure formula would not lead to a huge difference. Also, we detected that reducing the numbers of clusters leads to better results, which reduces the significance of result that could be stated.\\
	Using a different neural net architecture will most likely not chance the accuracy value drastically. As stated, more complex nets need more training data, which is restricted as mentioned above.\\
	What we can observe is, that using the stratified vectors, we are able to increase the performance and accuracy, but still have no sufficient predictions. Therefore we see that the more data we have the higher the variance within the stratas themselves is. We cannot draw some kind of lines to distinguish between different entries. Datapoints, which were outliers in the smaller sets, are now not considered to be outliers, because of large numbers having the same characteristics. So the lines, we were able to draw for smaller datasets, are blurring and create some kind of transition phase.\\ %TODO: letzter satz doof	
	
	
	\section{Discussion} \label{sec: discussion}
	%TODO: discussion
%	TODO (2 page)
%	\begin{itemize}
%		\item repr. working day
%		\item over/under std's
%		\item indiv. of lifestyle
%		\item inv. behaviour in same strata
%	\end{itemize}
	Regarding the results, of not predicting the strata and also not observing any meaningful clusters throughout the data in given and stratified form, we though about various aspects having an impact on the movement. We state 4 main influencing aspects, explaining the variance throughout the data.
	
	\subsection{Representativity of the day}
	The day the data was collected on (c.f. \Cref{sec: introduction}) is not mentioned. Therefore we can not infer that it is representative. The people asked to enter their movement could have a exceptional day, like a vacation day, a doctors appointment or a broken car and therefore behave different from a usual day. \\
	Also the day itself is not mentioned, so we don't have information if it was even a working day or a weekend. This influences the behavior drastically.
	
	\subsection{People living over/under standards}
	%TODO 
	
	\subsection{Individuality of lifestyle}
	Obviously, people are individual in their way of life. So there are people, with enough money to buy for example a car, but refuse to in order to reduce CO$_2$ emission, or simply don't like driving. On the other end of the spectrum, some people, who have little money still own and drive a car daily in order to go to work, since they can't afford an other apartment.\\
	One can think of multitude scenarios, of people behaving different, cause by their individuality.
	
	\subsection{Inverse behavior in a strata}
	As an example, take a look at the strata 6, which denotes the richest people considered. Their we have inter alia two groups: 
	\begin{enumerate}
		\setlength{\itemindent}{1cm}
		\item[1. Group]
		Hard working people, laboring 60+ hours per weak to earn their money. One can imagine that they have to move quite a lot since they are always busy.
		\item[2. Group]
		People, who are rich just by birth, which don't have the necessity to work or move at all. They could possibly stay home and don't have to leave at all.
	\end{enumerate} 
	Those two groups are completely opposite, but still belong to the same strata. Now also considering strata one, we can find the exact same movement behavior in there as well. Within the poorest there are people that are wandering around the town via feet or bike, since they have no objective, like work. Also there are people, who don't move at all, because of the same reason.	
	
	So we can see that based on the information we have it is very unlikely to have a precise correlation between the given data and the strata. However given more information about the previously mentioned aspects and more entries in general there could be some kind correlation to be found.\\
	Future work could include a component analysis of the decision tree and neural network in order to ascertain the influencing parts and therefore improve the data gathering. Also one could use different network visualization tools in order to infer their own patterns. An example would be to take the origin (destination) sectors as nodes, an edge if there is a movement, directed or undirected, and a different thickness or color gradient based on the number of this edge being taken.\\
	
	Overall we can conclude that with the data we got we are not able to find a correlation.
	
	
	\begin{thebibliography}{8}
		\bibitem{rich_do_not_rise_early}
		Lotero, Laura, et al. "Rich do not rise early: spatio-temporal patterns in the mobility networks of different socio-economic classes." Royal Society open science 3.10 (2016): 150654.
		
		\bibitem{strata_def}
		Hudson, Rex A. Colombia: A country study. Government Printing Office, 2010.
		
	\end{thebibliography}
\end{document}
